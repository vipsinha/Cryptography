# Cryptography
- It provides a set of methods, which enable application and system developer
to store and transmit information while safeguarding it from intruders.
- It provides cryptographic methods to keep critical information in confidential and / or authentic form, and to communicate in a way such that only the intended recipient can read
the message.

## Cryptography is divided into
- Crypto provider
    - Mechanisms for building applications that ensure the following security goals
        - Authenticity 
        - Non repudiation
        - Confidentiality
        - Integrity
- Key storage provider
    - The purpose of this element is secure persistent storage of any supported cryptographic objects
      and programmatic access to them via a unified interface, independently from actual
      physical storage implementations. Guaranteeing correct access to the keys, CryptoAPI restricts access to this material.
- x509 certificate management
    - It allows to manage PKI certificates. Here, all typical certificate handling mechanism,
      such as issuing, revocation, and replacement, are handled. Additionally, certificate
      management API provides a kind of permanent storage where all certificates are
      stored. All operations on certificates are done by certificate management, which enforces access permissions by implementing the Policy Enforcement Point.

### Below diagram provides the overview of cryptography

<img src="pictures/Diagram_view.jpeg"/>

- Application of crypto modules
    - Trusted application like Function clusters (Com, DM, PM etc)
    - Non Trusted application like Adaptive application

- Types of key slots
    - Application : 
        - The application has exclusive access to this key slot. It is able to import/export, update/delete and use the contained key-material. No other application 
        or Functional Cluster may access this Key Slot.
        - It is __exclusive__ to an application

    - Machine : 
        - This type of Key Slot is defined by the adaptive machine and may be
        used by the Functional Cluster for which it is configured. Additionally, the
        Key Slot may be assigned to a single Adaptive Application that is then
        able to manage the contained key-material.
        - It can be used by __any__ (Function cluster or adaptive application)

- IO Interface
    - It simplify interaction between domains
    - It abstract interfaces from the actual object the IOInterface interface has been introduced as an intermediate layer between the persistent resource and the runtime object. For example, it can be used by an application to instantiate
    a runtime crypto-object from its persistent storage location (read-access) like for KDF. Or it can be used by an application to store a runtime crypto-object into a persistent storage location (write-access) like MAC.

## Crypto API elements

### Hash / Digest
A hash-function is a one-way function and maps an arbitrary string of bits to a fixedlength string of bits. Due to its nature the bit string result is practical infeasible to
invert. 

### RNG
Generating randomness or pseudo randomness is required for many operations such
as creating Salts or Nonces. In order to enable applications to perform these operations, CryptoAPI provides an interface to generate random data. Randomness can be generated by True Random Number Generators (TRNGs) or by Cryptographically Secure Pseudo Random Number Generators (CSPRNGs).

The entropy is used to generate a deterministic but unpredictable stream of
random data. 

### KDF
- Derives a key from a base key, creating a new key object.

### Key Agreement

### Verifier public / Message Recovery public / Encryptor public

### Signer private / Signature Encode private / DecryptorPrivateCtx 
Digital signature contributes to goal authenticity when information is transferred. Guaranteeing the authenticity of the information asymmetric cryptography is used, where
the information is signed by a private key and verified later by using the matching public key. When the verification is successful, the receiver of the information can be sure that the owner of the private key is the sender of the information.

### MAC
- If signing include HMAC, CMAC (symmetric key), then it is called Mac

### Symmetric encryption
Symmetric encryption uses a shared secret (e.g., share key) to encrypt and / or decrypt
an information. Without knowing the key, the information cannot be understood by
anyone

#### Block cipher
Data with a fixed length is transformed (en/decrypted). The
system can only process complete blocks of data held in its internal memory.

#### Stream cipher
Information is encrypted as it streams instead of being retained in the system’s memory.

### Asymmetric encryption
Asymmetric encryption, asymmetric cryptography, or public key cryptography is a system, which is based on a pair of keys, public key and private key. As the name suggest, a public key can be distributed public to everyone without losing secrecy. Instead, a private key must be kept secret. Compared to symmetric cryptography, every user, who possesses the public key, can encrypt information, but only the user with the private key can decrypt the information.

### Authenticated cipher
Authenticated Encryption (AE) or Authenticated Encryption with Associated Data (
AEAD) provide confidentiality and data authenticity simultaneously. AEAD adds the ability to check the integrity and authenticity of some Associated Data (AD), also called ”additional authenticated data”. Additionally, this mechanism adds an Message Authentication Code (MAC), to conform that encrypted
data is authentic.

### Key wrap
- wraps (i.e., encrypts) a private or secret key.
- Key Wrapping encapsulates Key Material, which is used for example to store a key in an unsecure environment or transport a key by an unsecure channel. Wrapping a key is a kind of encryption of the key and contributes to confidentiality.
- Wrapping a key requires a KEK. With the call of the CryptoAPI interface the KEK is set (deployed) to the key wrapper algorithm context. Additionally, a ”direction” indicator is used to define the transformation direction, such as wrapping, unwrapping, signature calculation, or signature verification.

### Key Encapsulation public
- A key encapsulation mechanism (KEM) works just like a public-key encryption
scheme, except that the encryption algorithm takes no input other than another key.
Therefore, the KEM uses randomly generated Key Material, the key encryption key
(KEK), to encapsulate an input, in this situation a key. The input is encapsulated with
an encryption with a target public key.
- data encapsulation mechanism and provides a ”crypto envelope” or ”digital envelope” that protects the secrecy and integrity of data using symmetric-key cryptographic techniques concept

### Key Decapsulation private

### Generate private key, generate seed and generate symmetric key

#### Symmtric key
-  A symmetric system consists of a key, which is shared
between the different parties

#### Asymmetric key
- Asymmetric systems consist of public and private key,
which are generated. The public key is used for encryption, key encapsulation, or
signature verification. The private key is used for decryption, key dencapsulation,
key exchange, or digital signature calculation.

### Export Secured object / Import Secured Object / Export Publicly

### X.509 Certificate handling
#### Defination
X.509 Certificate Management Provider (X.509 Provider) is responsible for X.-
509 certificates parsing, verification, authentic storage and local searching by different attributes. In addition, X.509 Provider is responsible for storage, management, and processing of Certificate Revocation Lists (CRLs) and Delta CRLs. The X.509 Provider supports the preparation of requests, responses, and parsing according to the Online Certificate Status Protocol (OCSP) 
#### Main features
A PKI contains a root certificate and one or many certificates. Main feature are:
    - Storages of certificates, certification signing requests (CSRs), and certificate revocation lists (CRLs).
    - Complete parsing of X.509 certificates and certificate signing requests (CSR).
    - Encoding of all public components of certificate signing requests (e.g. Distinguished Names and X.509 Extensions).
    - Verification of certificates and certification chains (according to current set of trusted certificates).
    - Trust management of the stored certificates.
    - Search of certificates in local storage based on different parameters.
    - Automatic building of the trust chains according to saved certificates, CRLs, and
    trust configuration.
#### Certificate fields
The X.509 Provider shall support ASN.1 parsing. Thus it provides an ASN.1 parser to read the specific syntax of X.509 certificates. Typical X.509 certificates must follow the definition given in [32] and [33, RFC 5280]:
1. Certificate
    - Version Number
    - ara::crypto::x509::Certificate::SerialNumber
    - Signature Algorithm ID
    - ara::crypto::x509::Certificate::IssuerDn
    - Validity period
        - ara::crypto::x509::Certificate::StartTime
        - ara::crypto::x509::Certificate::EndTime
    - ara::crypto::x509::BasicCertInfo::SubjectDn
    -  Subject Public Key Info
        - Public Key Algorithm
        - Subject Public Key
    - Issuer Unique Identifier (optional)
    - Subject Unique Identifier (optional)
    - Extensions (optional)
2. Certificate Signature Algorithm
3. Certificate Signature

